import pyautogui
import time
from ...functions import functions_ark as ark
import os
import keyboard

ark.log_it(f'Started {os.path.basename(__file__)}')

ark.action_start('Arknights', 1242, 812, 339, 164)
time.sleep(.6)
pyautogui.click(x=472, y=321) # open rest
time.sleep(1)

ark.drag_down()

pyautogui.click(x=993, y=503) ## 1
time.sleep(1)
pyautogui.click(x=836, y=931)
time.sleep(.6)
pyautogui.click(x=1188, y=235)
time.sleep(1)
pyautogui.moveTo(1451, 431)
pyautogui.mouseDown()
pyautogui.moveTo(946, 453, 1)
time.sleep(1)
pyautogui.mouseUp()
time.sleep(.6)
pyautogui.moveTo(1451, 431)
pyautogui.mouseDown()
pyautogui.moveTo(946, 453, 1)
time.sleep(1)
pyautogui.mouseUp()
time.sleep(.6)
pyautogui.click(x=1087, y=683)
time.sleep(.6)
pyautogui.click(x=1503, y=695)
time.sleep(.6)
pyautogui.click(x=1359, y=419)
time.sleep(.6)
pyautogui.click(x=1362, y=693)
time.sleep(.6)
pyautogui.click(x=1084, y=444)
time.sleep(.6)
pyautogui.click(x=1470, y=932)
time.sleep(1)
pyautogui.click(x=1540, y=931)
time.sleep(10)

ark.drag_down()

pyautogui.click(x=993, y=609) ## 2
time.sleep(1)
pyautogui.click(x=836, y=931)
time.sleep(.6)
pyautogui.click(x=1188, y=235)
time.sleep(.6)
pyautogui.click(x=1188, y=235)
time.sleep(1)
pyautogui.moveTo(1451, 431)
pyautogui.mouseDown()
pyautogui.moveTo(946, 453, 1)
time.sleep(1)
pyautogui.mouseUp()
time.sleep(.6)
pyautogui.click(x=1425, y=428)
time.sleep(.6)
pyautogui.click(x=1433, y=691)
time.sleep(.6)
pyautogui.click(x=1156, y=428)
time.sleep(.6)
pyautogui.click(x=1157, y=692)
time.sleep(.6)
pyautogui.click(x=1286, y=427)
time.sleep(.6)
pyautogui.click(x=1470, y=932)
time.sleep(1)
pyautogui.click(x=1540, y=931)
time.sleep(10)

ark.drag_down()

pyautogui.click(x=987, y=736) ## 3
time.sleep(1)
pyautogui.click(x=836, y=931)
time.sleep(.6)
pyautogui.click(x=1188, y=235)
time.sleep(.6)
pyautogui.click(x=1188, y=235)
time.sleep(1)
pyautogui.click(x=1500, y=440)
time.sleep(.6)
pyautogui.click(x=1361, y=421)
time.sleep(.6)
pyautogui.click(x=1502, y=689)
time.sleep(.6)
pyautogui.click(x=1233, y=431)
time.sleep(.6)
pyautogui.click(x=1216, y=690)
time.sleep(.6)
pyautogui.click(x=1470, y=932)
time.sleep(1)
pyautogui.click(x=1540, y=931)
time.sleep(10)

ark.drag_down()

pyautogui.click(x=987, y=844)
time.sleep(1)
pyautogui.click(x=836, y=931)
time.sleep(.6)
pyautogui.click(x=1188, y=235)
time.sleep(.6)
pyautogui.click(x=1188, y=235)
time.sleep(1)
pyautogui.click(x=1090, y=439)
time.sleep(.6)
pyautogui.click(x=1090, y=687)
time.sleep(.6)
pyautogui.click(x=949, y=439)
time.sleep(.6)
pyautogui.click(x=949, y=687)
time.sleep(.6)
pyautogui.click(x=818, y=687)
time.sleep(.6)
pyautogui.click(x=1470, y=932)
time.sleep(1)
pyautogui.click(x=1540, y=931)
time.sleep(10)

keyboard.press_and_release('esc')
time.sleep(2)

ark.log_it(f'Ended {os.path.basename(__file__)}')