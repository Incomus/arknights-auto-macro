import pyautogui
import time
from ...functions import functions_ark as ark
import os
import keyboard

ark.log_it(f'Started {os.path.basename(__file__)}')

ark.action_start('Arknights', 1242, 812, 339, 164)
time.sleep(.6)
pyautogui.click(x=472, y=321) # open rest
time.sleep(1)

ark.drag_down()

pyautogui.click(x=993, y=507) ## 1
time.sleep(1)
pyautogui.click(x=836, y=931)
time.sleep(.6)
pyautogui.click(x=1188, y=235)
time.sleep(1)
pyautogui.click(x=1230, y=698)
time.sleep(.6)
pyautogui.click(x=1270, y=233)
time.sleep(.6)
pyautogui.click(x=1270, y=233)
time.sleep(1)
pyautogui.click(x=1091, y=444)
time.sleep(.6)
pyautogui.click(x=953, y=439)
time.sleep(.6)
pyautogui.click(x=944, y=709)
time.sleep(.6)
pyautogui.click(x=811, y=709)
time.sleep(.6)
pyautogui.click(x=1470, y=932)
time.sleep(1)
pyautogui.click(x=1540, y=931)
time.sleep(10)

ark.drag_down()

pyautogui.click(x=993, y=610) ## 2
time.sleep(1)
pyautogui.click(x=836, y=931)
time.sleep(.6)
pyautogui.click(x=1188, y=235)
time.sleep(1)
pyautogui.click(x=1370, y=433)
time.sleep(.6)
pyautogui.click(x=1270, y=233)
time.sleep(.6)
pyautogui.click(x=1270, y=233)
time.sleep(1)
pyautogui.click(x=1091, y=444)
time.sleep(.6)
pyautogui.click(x=953, y=439)
time.sleep(.6)
pyautogui.click(x=944, y=709)
time.sleep(.6)
pyautogui.click(x=811, y=709)
time.sleep(.6)
pyautogui.click(x=1470, y=932)
time.sleep(1)
pyautogui.click(x=1540, y=931)
time.sleep(10)

ark.drag_down()

pyautogui.click(x=987, y=730) ## 3
time.sleep(1)
pyautogui.click(x=836, y=931)
time.sleep(.6)
pyautogui.click(x=1188, y=235)
time.sleep(1)
pyautogui.click(x=1085, y=445)
time.sleep(.6)
pyautogui.click(x=1270, y=233)
time.sleep(.6)
pyautogui.click(x=1270, y=233)
time.sleep(1)
pyautogui.click(x=1091, y=444)
time.sleep(.6)
pyautogui.click(x=953, y=439)
time.sleep(.6)
pyautogui.click(x=944, y=709)
time.sleep(.6)
pyautogui.click(x=811, y=709)
time.sleep(.6)
pyautogui.click(x=1470, y=932)
time.sleep(1)
pyautogui.click(x=1540, y=931)
time.sleep(10)

ark.drag_down()

pyautogui.click(x=987, y=844) ## 4
time.sleep(1)
pyautogui.click(x=836, y=931)
time.sleep(.6)
pyautogui.click(x=1188, y=235)
time.sleep(1)
pyautogui.click(x=1216, y=429)
time.sleep(.6)
pyautogui.click(x=1270, y=233)
time.sleep(.6)
pyautogui.click(x=1270, y=233)
time.sleep(1)
pyautogui.click(x=1091, y=444)
time.sleep(.6)
pyautogui.click(x=953, y=439)
time.sleep(.6)
pyautogui.click(x=944, y=709)
time.sleep(.6)
pyautogui.click(x=811, y=709)
time.sleep(.6)
pyautogui.click(x=1470, y=932)
time.sleep(1)
pyautogui.click(x=1540, y=931)
time.sleep(10)

keyboard.press_and_release('esc')
time.sleep(2)

ark.log_it(f'Ended {os.path.basename(__file__)}')